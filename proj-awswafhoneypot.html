
<!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" href="assets/img/logo-32x32.png" sizes="32x32"/>
    <link rel="icon" href="assets/img/logo-192x192.png" sizes="192x192"/>

    <title>Phishy.Cloud | Cybersecurity &amp; Cloud Projects, Coding Scripts &amp; More</title>

    <link href="assets/css/plugins.css" rel="stylesheet"/>
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WHEVLBDVK8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WHEVLBDVK8');
</script>
	
</head>

<body class="v-light bg-dots dsn-ajax">


<div id="dsn_preloader" class="preloader">

    <div class="dsnload p-absolute">
        <span class="dsnload__row">
            <span class="dsnload__img">
            <img src="assets/img/logo-light.png" class="logo-dark" alt="Phishy.Cloud" decoding="async" loading="lazy"/>
            <img src="assets/img/logo.png" class="logo-light" alt="Phishy.Cloud" decoding="async" loading="lazy"/>
            </span>
        </span>
        <span class="dsnload__row dsnload__row--sibling">
            <span class="dsnload__img">
                 <img src="assets/img/logo-light.png" class="logo-dark" alt="Phishy.Cloud" decoding="async" loading="lazy"/>
            <img src="assets/img/logo.png" class="logo-light" alt="Phishy.Cloud" decoding="async" loading="lazy"/>
            </span>
        </span>
        <span class="dsnload__row dsnload__row--sibling">
            <span class="dsnload__img">
                <img src="assets/img/logo-light.png" class="logo-dark" alt="Phishy.Cloud" decoding="async" loading="lazy"/>
            <img src="assets/img/logo.png" class="logo-light" alt="Phishy.Cloud" decoding="async" loading="lazy"/>
            </span>
        </span>
        <span class="dsnload__row dsnload__row--sibling">
            <span class="dsnload__img">
               <img src="assets/img/logo-light.png" class="logo-dark" alt="Phishy.Cloud" decoding="async" loading="lazy"/>
            <img src="assets/img/logo.png" class="logo-light" alt="Phishy.Cloud" decoding="async" loading="lazy"/>
            </span>
        </span>


    </div>
    <svg width="100%" height="100%" viewBox="0 0 100 100" class="v-middle" preserveAspectRatio="xMinYMin meet"
         fill="none">
        <linearGradient id="linearColors" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="var(--theme-color)"></stop>
            <stop offset="50%" stop-color="var(--border-color)"></stop>
            <stop offset="100%" stop-color="var(--assistant-color)"></stop>
        </linearGradient>
        <path class="dsn-progress-path" d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
    </svg>
    <div class="loading-circle v-middle">
        <p class="loading-count v-middle">0</p>
    </div>

    <div class="bg-load background-section d-flex align-items-end">
        <svg class="dsn-separator-bottom dsn-icon-assistant-color" width="100%" height="100%" viewBox="0 0 100 10"
             preserveAspectRatio="none">
            <path class="path-anim separator__path" data-dsn-to="M 0 0 C 40 0 55 0 100 0 L 0 0 Z"
                  vector-effect="non-scaling-stroke" d="M 0 0 C 40 16 75 10 100 0 L 0 0 Z"></path>
        </svg>
    </div>

</div>

<main id="main_root" class="main-root">

    <!-- ========== Menu ========== -->
    <header id="site_menu_header" class="site-header  dsn-container d-none dsn-hamburger">
        <div class="main-logo">
            <a href="index.html" data-dsn-text="Phishy.Cloud" class="custom-logo-link main-brand effect-ajax" rel="home"
               aria-current="page">
                <img src="assets/img/logo-light.png" class="custom-logo logo-light" alt="Phishy.Cloud"/>
                <img src="assets/img/logo.png" class="custom-logo logo-dark" alt="Phishy.Cloud"/>
            </a>
        </div>
        <nav class="main-navigation ">
            <div class="menu-cover-title header-container dsn-container">MENU</div>
            <ul id="dsn-primary-list" class="primary-nav h2">
                <li class="nav-item has-sub-menu">
                <li class="nav-item ">
                    <a title="Home" href="index.html">
                        <span class="overflow">Home</span>
                    </a>
                </li>
                <li class="nav-item ">
                    <a title="Home" href="about.html">
                        <span class="overflow">About</span>
                    </a>
                </li>
                <li class="nav-item ">
                    <a title="Home" href="portfolio.html">
                        <span class="overflow">Portfolio</span>
                    </a>
                </li>
                <li class="nav-item ">
                    <a title="Home" href="contact.html">
                        <span class="overflow">Contact</span>
                    </a>
                </li>
            </ul>
            <div class="container-content  d-flex flex-column justify-content-center section-margin">
                <div class="nav__info">
                    <div class="nav-content">
                        <h5 class="sm-title-block mb-10">Located in</h5>
                        Orange County, CA

                    </div>
                </div>
                <div class="nav-social nav-content mt-30">
                    <div class="nav-social-inner p-relative">
                        <h5 class="sm-title-block mb-10">Connect with me</h5>
                        <ul style="--dsn-li-name: dsn6;">
                            <li style="--dsn-li-index: 2;"><a href="https://www.linkedin.com/in/richgerg/" target="_blank"
                                                              rel="nofollow noopener noreferrer">Linkedin.</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
        <div id="navbar_toggle" class="navbar-toggle">
            <div class="toggle-icon">
                <div class="toggle-line"></div>
                <div class="toggle-line"></div>
                <div class="toggle-line"></div>
            </div>
            <div class="toggle-text">
                <div class="text-menu">Menu</div>
                <div class="text-open">Open</div>
                <div class="text-close">Close</div>
            </div>
        </div>
        <div class="bg-load background-main"></div>

        <svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none"
             class="bg-load dsn-svg-transition">
            <path vector-effect="non-scaling-stroke" d="M 0 100 V 100 Q 50 100 100 100 V 100 z"/>
        </svg>

    </header>
    <!-- ========== End Menu ========== -->


    <!-- ========== Header  ========== -->
    <header id="dsn_header" class="dsn-header-animation  dsn-full-header v-dark-head">
        <div class="entry-header p-relative over-hidden">
            <div id="hero_image"
                 class="p-absolute dsn-hero-parallax-img over-hidden before-z-index z-index-1 full-width"
                 data-dsn-ajax="img" data-overlay="6">
                <img src="assets/img/proj/proj-wafhoneypot3.jpg"
                     class="cover-bg-img transform-3d " alt=""
                     data-dsn-position="50% 50%"
                     sizes="(max-width: 2560px) 100vw, 2560px"/>
            </div>
            <div id="hero_content" class="d-flex p-relative h-100 dsn-hero-parallax-title align-items-end container">
                <div class="content p-relative ">
                    <div class="intro-project w-100">
                        <div class="intro-title ">
                            <div id="dsn_metas" class="p-relative d-flex justify-content-between ">
                                <div class="metas has-separate p-relative mb-10">
                                    <span>Cloud</span>
                                </div>
                            </div>
                            <div id="hero_title">
                                <h1 class="title text-upper" data-dsn-ajax="title">AWS WAF &amp; Honeypot</h1>
                            </div>

                        </div>

                    </div>

                </div>

            </div>

        </div>

    </header>
    <!-- ========== End Header  ========== -->

    <div id="page_wrapper" class="wrapper">

        <div class="root-blog">
            <div class="container ">
                <div class="dsn-posts">


                    <div class="news-content mt-section">
                        <div class="news-content-inner">

                            <div class="post-content">
                                <p>
                                    <a>Objective</a><br>
                                Analyze the data from a <a href="proj-awshoneypot.html">T-Pot honeypot deployed on AWS EC2</a> and leverage the findings to create a Web Application Firewall (WAF) with custom rules. The WAF will be designed to reduce future attacks by blocking known attackers based on collected data. </p>
								
                                <p>
                                    <a>T-Pot Insights</a><br>
                                I've observed a variety of interesting insights gained from the honeypot over the last 10 days to include:<br><br>
								• Over 670,000 events recorded from over 6,400 unique IP addresses<br>
								• 88% of the source IP addresses have been identified as "known attackers"<br>
									• The top 5 countries associated with the attacking IP addresses are as follows: India (18%), Vietnam (14%), China (13%), USA (12%) and Russia (10%)<br>
									• Among the client software detected on the honeypot, 86% of them have been using ZGrab. ZGrab is a network scanning tool designed to collect data from various services and protocols such as HTTP, HTTPS, FTP, SMTP, IMAP, POP3, DNS, SSH, and more. It can gather specific information like SSL/TLS certificates, HTTP headers, email information, DNS data, etc.<br>
									• The most common port destinations targeted by the attackers are as follows: 445 (Typically File Sharing &amp; Active Directory), 53 (DNS), 5900 (Virtual Network Computing, allowing remote access &amp; control), 547 (DHCP) and 80 (Web Server/HTTP)
								</p>
								
								<p>
                                    <a>Introduction</a><br>
                                10 days ago, I deployed a T-Pot honeypot on AWS EC2 to capture and analyze incoming attack traffic. Now I am utilizing the insights gained from analyzing the honeypot data to develop and implement a WAF for enhanced attack detection and prevention.
								</p>

                                <p>
                                    <a>Tools &amp; Technologies Used</a><br>
                                    AWS Web Application Firewall (WAF), Aplication Load Balancer (ALB), AWS EC2, Custom Inbound Rules, T-Pot (Honeypot)
                                </p>
								
								<img class="w-100" src="assets/img/proj/mock9.jpg" alt="">
								
                                <p>
                                    <a>Implementation</a><br>
                                    <em>1. Create Application Load Balancer (ALB):</em><br> 
									An ALB is created to distribute incoming traffic to multiple targets. In this case, the ALB acts as a connection point between the WAF and the honeypot deployed on EC2.<br><br>

									<em>2. Create a WAF and Custom Rules:</em><br>
									Once the WAF is established, and custom rules are created based on the analysis of honeypot data. For testing purposes, three rules are implemented:<br>
									A. Blocking the top 10 IP addresses identified as "known attackers."<br>
									B. Blocking IP addresses originating from the top countries associated with attack traffic (excluding the United States).<br>
									C. Blocking any IP address that exceeds 500 requests within a 5-minute timeframe, deemed to be non-human behavior (potentially ZGrab or Nmap scans).<br><br>
									NOTE: Blocking entire countries may not be suitable in all real-world scenarios due to various factors such as VPN access requirements or the utilization of contractors in those countries. Considerations should be made based on individual company requirements.<br><br>

									<em>3. Connect the WAF to the Load Balancer:</em><br>
									Under the "Associated AWS resources" section of the WAF, the ALB is added as the associated resource to enable traffic filtering.<br><br>
									
									<img class="w-100" src="assets/img/proj/mock11.jpg" alt="">

									<em>4. Connect the Load Balancer to the EC2 Instance:</em><br>
									In the EC2 console, the security group for the EC2 instance is modified by adding a new inbound rule that permits traffic from the load balancer's security group ID.<br><br>

									<em>5. Monitor and Test:</em><br>
									Almost immediately, new observations show that incoming requests originate primarily from allowed countries (e.g., the United States), while other types of requests cease. The total number of events significantly decreased, likely due to the automatic blocking of IP addresses making more than 500 requests within a 5-minute span.<br><br>
									
									Before the integration of the WAF and custom rules, the honeypot experienced an average of nearly 5,000 events per hour. However, with the implementation of the WAF and the enforcement of the custom rules, the event count has significantly reduced to an average of 50 events per hour. This represents a remarkable decrease of 99%.<br><br>

                              </p>
								
								<img class="w-100" src="assets/img/proj/mock10.jpg" alt="">
								
                                <p>
                                    <a>Challenges &amp; Lessons Learned</a><br>
                                    One challenge encountered during this process was understanding the purpose and functioning of an Application Load Balancer (ALB). However, after learning about ALBs and watching tutorial videos on setting up the connection between the ALB, WAF, and EC2 instances, the rest of the process proceeded smoothly.
                                </p>
								

                                <p>
                                    <a>Conclusion</a><br>
                                    The overall process of setting up the T-Pot honeypot, monitoring attacks, analyzing data, and creating rules for future attack mitigation on AWS was highly engaging. The ability to witness real-time changes in attack maps and dashboards, along with the reduction in attack events, provided rewarding insights.
<br><br>
Future refinement of this approach could involve detecting additional attack methods and continuously updating the list of known attackers to enhance the security measures. However, due to cost considerations related to the large number of Docker containers required (18 containers across t3.xlarge instances with 128GB RAM ouch!), the honeypot will be temporarily disabled. Nevertheless, this experiment served as a valuable learning experience in AWS and cybersecurity defensive measures.
									
                                </p>

                                <div class="post-tags p-relative">
                                    <!-- <a class="fz-16"
                                       href="#">
                                        <span class="post_tag post_tag">Blog</span>
                                    </a>
                                    <a class="fz-16" href="#">
                                        <span class="post_tag post_tag">Creative</span>
                                    </a> -->
                                </div>

                            </div>

                            <!-- <div class="pagination-post d-flex align-items-center border-style border-radius mt-section">

                                <div class="pagination-item w-100 p-20"><a
                                        href="https://dsngrid.com/blackdsn/2022/06/11/create-the-bestworkplace/"><span
                                        class="mb-5">PREVIOUS</span><h4 class="title-block word-wrap">Create the
                                    bestworkplace</h4></a></div>

                                <div class="icon p-20 border-right border-left">
                                    <a class="h-100 heading-color" href="#">
                                        <i class="fas fa-th-large" aria-hidden="true"></i>
                                    </a>
                                </div>
                                <div class="pagination-item w-100 p-20 text-right"><a
                                        href="https://dsngrid.com/blackdsn/2022/06/11/soul-artwork-from-lizzy/"><span
                                        class="mb-5">NEXT</span><h4 class="title-block word-wrap">Soul Artwork from
                                    Lizzy</h4></a></div>
                            </div> -->
                        </div>
                    </div>
                </div>

            </div>
        </div>


        <!-- ========== Footer ========== -->
        <footer id="dsn_footer" class="dsn-footer p-relative footer-animate svg-animate background-section">
            <svg class="dsn-separator dsn-separator-up  dsn-icon-main-color" width="100%" height="100%"
                 viewBox="0 0 100 10" preserveAspectRatio="none">
                <path class="path-anim separator__path" data-dsn-to="M 0 0 C 40 0 55 0 100 0 L 0 0 Z"
                      vector-effect="non-scaling-stroke" d="M 0 0 C 40 16 75 10 100 0 L 0 0 Z"></path>
            </svg>
            <div class="footer-content p-relative mt-section">

                <div class="text-center container">
                    <h2 class="title-h2 ">
                        Want to talk?
                        <span class="d-block"><b><i>Let's connect </i></b></span>
                    </h2>
                    <div class="dsn-icon-heading-color dsn-def-btn d-flex justify-content-center mt-30">
                        <a class="dsn-btn dsn-border border-color-default  background-main  effect-ajax has-icon-left"
                           href="contact.html" data-dsn-text="START A PROJECT">
                        <span class="dsn-icon dsn-bg-before btn-icon-left heading-color z-index-1">
                            <i class="fas fa-angle-right" aria-hidden="true"></i>
                        </span>
                            <span class="title-btn p-relative  z-index-1 ">REACH OUT</span>
                        </a>
                    </div>

                </div>
                <div class="dsn-container pt-60">
                    <div class="d-grid grid-lg-4 grid-md-2 ">
                        <div class="grid-col-1">
                            <div class="dsn-logo main-logo">
                                <div class="main-logo">
                                    <a href="index.html" data-dsn-text="Phishy.Cloud"
                                       class="custom-logo-link main-brand effect-ajax" rel="home">
                                        <img class="custom-logo logo-light" src="assets/img/logo-light.png"
                                             alt="Phishy.Cloud"/>
                                        <img class="custom-logo logo-dark" src="assets/img/logo.png"
                                             alt="Phishy.Cloud"/>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="grid-col-2">
                            <h4 class="subtitle p-relative line-shape  line-shape-after "><span
                                    class="background-revere ">NAVIGATION</span>
                            </h4>
                            <div class="menu-footer-menu-container">
                                <ul id="menu-footer-menu" class="menu">
                                    <li class="menu-item">
                                        <a href="index.html" class="effect-ajax">HOME</a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="about.html" class="effect-ajax">ABOUT</a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="portfolio.html" class="effect-ajax">PORTFOLIO</a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="contact.html" class="effect-ajax">CONTACT</a>
                                    </li>

                                </ul>
                            </div>
                        </div>
                        <div class="grid-col-3">
                            <h4 class="subtitle p-relative line-shape  line-shape-after "><span
                                    class="background-revere ">CONNECT WITH ME</span>
                            </h4>

                            <div class="col-contact">
                                <p class="over-hidden mt-10">
                                    LinkedIn : <a class="link-hover" href="https://www.linkedin.com/in/richgerg/" target="_blank" data-hover-text="@richgerg">@richgerg</a>
                                </p>
                            </div>

                        </div>
                        <div class="grid-col-4">
                            <h4 class="subtitle p-relative line-shape  line-shape-after "><span
                                    class="background-revere ">LOCATED IN</span>
                            </h4>
                            <div class="col-address">
                                <p>
                                    Orange County, CA
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="footer-bottom mt-60 pt-30 border-top pb-30 text-center">
                        <p class="over-hidden">
                            2023 © Phishy.Cloud by Rich Gergely. All Rights Reserved.
                        </p>
                    </div>
                </div>


            </div>
        </footer>
        <!-- ========== End Footer ========== -->

    </div>


</main>

<!-- ========== Cursor ========== -->
<div id="dsn_cursor" class="ball"></div>
<div id="dsn_cursor_inner" class="ball"></div>
<!-- ========== End Cursor ========== -->


<!-- ==========  Social ========== -->
<div class="social-side d-flex align-items-center flex-column justify-content-center">

    <ul class="socials d-flex flex-column-reverse">
        <li style="--dsn-index-animate : 3;">
            <a href="https://www.linkedin.com/in/richgerg/" target="_blank" rel="nofollow">
                <i class="fab fa-linkedin-in" aria-hidden="true"></i><span>LinkedIn</span>
            </a>
        </li>
    </ul>
    <div class="icon">CONNECT</div>
</div>
<!-- ========== End Social ========== -->

<!-- ========== Style Option Page ========== -->
<div id="dsn_box_options" class="day-night">
    <div class="night active" data-dsn-theme="dark">
        <svg width="48" height="48" viewBox="0 0 48 48">
            <rect x="12.3" y="23.5" width="2.6" height="1"></rect>
            <rect x="16.1" y="15.3" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8871 16.5732)" width="1"
                  height="2.6"></rect>
            <rect x="23.5" y="12.3" width="1" height="2.6"></rect>
            <rect x="30.1" y="16.1" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -2.5145 27.0538)" width="2.6"
                  height="1"></rect>
            <rect x="33.1" y="23.5" width="2.6" height="1"></rect>
            <rect x="30.9" y="30.1" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -12.9952 31.4264)" width="1"
                  height="2.6"></rect>
            <rect x="23.5" y="33.1" width="1" height="2.6"></rect>
            <rect x="15.3" y="30.9" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -17.3677 20.9457)" width="2.6"
                  height="1"></rect>
            <path
                    d="M24,18.7c-2.9,0-5.3,2.4-5.3,5.3s2.4,5.3,5.3,5.3s5.3-2.4,5.3-5.3S26.9,18.7,24,18.7z M24,28.3c-2.4,0-4.3-1.9-4.3-4.3s1.9-4.3,4.3-4.3s4.3,1.9,4.3,4.3S26.4,28.3,24,28.3z">
            </path>
        </svg>

    </div>
    <div class="moon" data-dsn-theme="night">
        <svg width="48" height="48" viewBox="0 0 48 48">
            <path
                    d="M24,33.9c-5.4,0-9.9-4.4-9.9-9.9c0-4.3,2.7-8,6.8-9.4l0.8-0.3l-0.1,0.9c-0.2,0.6-0.2,1.3-0.2,1.9c0,5.2,4.3,9.5,9.5,9.5c0.6,0,1.3-0.1,1.9-0.2l0.8-0.2L33.3,27C32,31.1,28.3,33.9,24,33.9z M20.4,15.9c-3.2,1.4-5.3,4.5-5.3,8.1c0,4.9,4,8.9,8.9,8.9c3.6,0,6.7-2.1,8.1-5.3c-0.4,0-0.8,0.1-1.3,0.1c-5.8,0-10.5-4.7-10.5-10.5C20.4,16.7,20.4,16.3,20.4,15.9z">
            </path>
        </svg>
    </div>
</div>
<!-- ========== End Style Option Page ========== -->

<!-- ========== Line BG ========== -->
<div id="line_head"><span class="container"></span></div>
<!-- ========== End Line BG ========== -->

<script src="assets/js/jquery-3.1.1.min.js"></script>
<script src="assets/js/plugins.min.js"></script>
<script src="assets/js/plugins/dsn-grid.min.js"></script>
<script src="assets/js/custom.js"></script>

</body>

</html>
